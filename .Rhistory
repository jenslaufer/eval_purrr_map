knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
library(lubridate)
tibble(a=seq(today(),as.Date('2015-07-12'), by = '1 day'))
tibble(a=seq(today(),today() +20, by = '1 day'))
tibble(a=seq(today(),today() +30, by = '1 day'))
tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100)) %>%
tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100))
tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100)) %>%
mutate(group="group1")
tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100)) %>%
mutate(group="group1") %>%
bind_rows(tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100)) %>%
mutate(group="group2")) %>%
bind_rows(tibble(date=seq(today(),today() +30, by = '1 day'), value=runif(n = 31, 10,100)) %>%
mutate(group="group3"))
data <- tibble(date = seq(today(), today() + 30, by = '1 day'),
value = runif(n = 31, 10, 100)) %>%
mutate(group = "group1") %>%
bind_rows(tibble(
date = seq(today(), today() + 30, by = '1 day'),
value = runif(n = 31, 10, 100)
) %>%
mutate(group = "group2")) %>%
bind_rows(tibble(
date = seq(today(), today() + 30, by = '1 day'),
value = runif(n = 31, 10, 100)
) %>%
mutate(group = "group3"))
data %>%
group_by(group) %>%
nest()
? mapply(function, ...)
?map
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl=map(data, ~loess()))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl=map(data, ~loess(date~value, .)))
data %>%
group_by(group) %>%
mutate(timestamp=timestamp(date) %>%
nest() %>%
mutate(mdl=map(data, ~loess(timetsamp~value, .)))
data %>%
group_by(group) %>%
mutate(timestamp=timestamp(date) %>%
nest() %>%
mutate(mdl=map(data, ~loess(timestamp~value, .)))
data %>%
group_by(group) %>%
mutate(timestamp=timestamp(date)) %>%
nest() %>%
mutate(mdl=map(data, ~loess(timestamp~value, .)))
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
data %>%
group_by(group) %>%
mutate(timestamp=timestamp(date))
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
##------ 2020-05-17 ------##
##------ 2020-05-18 ------##
##------ 2020-05-19 ------##
##------ 2020-05-20 ------##
##------ 2020-05-21 ------##
##------ 2020-05-22 ------##
##------ 2020-05-23 ------##
##------ 2020-05-24 ------##
##------ 2020-05-25 ------##
##------ 2020-05-26 ------##
##------ 2020-05-27 ------##
##------ 2020-05-28 ------##
##------ 2020-05-29 ------##
##------ 2020-05-30 ------##
##------ 2020-05-31 ------##
##------ 2020-06-01 ------##
##------ 2020-06-02 ------##
##------ 2020-06-03 ------##
##------ 2020-06-04 ------##
##------ 2020-06-05 ------##
##------ 2020-06-06 ------##
##------ 2020-06-07 ------##
##------ 2020-06-08 ------##
##------ 2020-06-09 ------##
##------ 2020-06-10 ------##
##------ 2020-06-11 ------##
##------ 2020-06-12 ------##
##------ 2020-06-13 ------##
##------ 2020-06-14 ------##
##------ 2020-06-15 ------##
##------ 2020-06-16 ------##
data %>%
group_by(group) %>%
mutate(timestamp=strptime(date)) %>%
nest() %>%
mutate(mdl=map(data, ~loess(timestamp~value, .)))
data %>%
group_by(group) %>%
mutate(timestamp=strptime(date))
data <- tibble(step = seq(1, 31, 1),
value = runif(n = 31, 10, 100)) %>%
mutate(group = "group1") %>%
bind_rows(tibble(
step = seq(1, 31, 1),
value = runif(n = 31, 10, 100)
) %>%
mutate(group = "group2")) %>%
bind_rows(tibble(
step = seq(1, 31, 1),
value = runif(n = 31, 10, 100)
) %>%
mutate(group = "group3"))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl=map(data, ~loess(step~value, .)))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(m, `[[`, "fitted"))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted"))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest()
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_point(aes(y=fitted))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_lije(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data <- tibble(step = seq(1, 31, 1),
value = 24 + 5 * step) %>%
mutate(group = "group1") %>%
bind_rows(tibble(
step = seq(1, 31, 1),
value = value = 2.4 + 5.1 * step
data <- tibble(step = seq(1, 31, 1),
value = (24 + 5 * step)) %>%
mutate(group = "group1") %>%
bind_rows(tibble(
step = seq(1, 31, 1),
value = 2.4 + 5.1 * step
) %>%
mutate(group = "group2")) %>%
bind_rows(tibble(
step = seq(1, 31, 1),
value = -2 + 1.6 * step
) %>%
mutate(group = "group3"))
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data %>% group_by(grou), ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data %>% group_by(group), ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ lm(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
data %>%
group_by(group) %>%
nest() %>%
mutate(mdl = map(data, ~ loess(step ~ value, .)),
fitted = map(mdl, `[[`, "fitted")) %>%
select(-mdl) %>%
unnest() %>%
ggplot(aes(x=step)) +
geom_point(aes(y=value))+
geom_line(aes(y=fitted)) +
facet_wrap(~group)
