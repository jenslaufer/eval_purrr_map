---
title: "Eval 2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lubridate)
```

```{r}
data <- tibble(step = seq(1, 31, 1),
               value = (24 + 5 * step)) %>%
  mutate(group = "group1") %>%
  bind_rows(tibble(
    step = seq(1, 31, 1),
    value = 2.4 + 5.1 * step
  ) %>%
    mutate(group = "group2")) %>%
  bind_rows(tibble(
    step = seq(1, 31, 1),
    value = -2 + 1.6 * step
  ) %>%
    mutate(group = "group3"))
  
```


```{r}
data %>%
  group_by(group) %>%
  nest() %>%
  mutate(mdl = map(data, ~ loess(step ~ value, .)),
         fitted = map(mdl, `[[`, "fitted")) %>% 
  select(-mdl) %>% 
  unnest() %>% 
  ggplot(aes(x=step)) +
  geom_point(aes(y=value))+
  geom_line(aes(y=fitted)) +
  facet_wrap(~group)
```

