---
title: "Purr Eval"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

## Map

```{r}
c(1,2,3) %>% map(function(a) a^0.5)
```

```{r}
c(1,2,3) %>% map(sqrt)
```

```{r}
tibble(a=c(4,3,5), b=c(8,9,5)) %>%  map(sqrt)
```

```{r}
c(1,2,3) %>% map(~sqrt(.))
```

## Map2

```{r}
map2(c(1,3), c(4,8), function(a,b) a*b)
```

```{r}
map2(c(1,3), c(4,8), ~(..1)*(..2))
```

```{r}
c(1,3) %>% map2(c(4,8), ~(..1)*(..2))
```

## Multiple features

```{r}
list(list(5, 27, 50), list(1000, 1000, 1000)) %>%
  pmap(function(a,b) a*b)
```

```{r}
multiply <- function(a, b) {
  a * b
}
```

```{r}
list(list(5, 27, 50), list(1000, 1000, 1000)) %>%
  pmap( ~ multiply(..1, ..2))
```

## Other examples

```{r}
set.seed(12L)
tibble(group = "1",
       a = runif(10, 1, 1000),
       b = runif(10, 1, 1000)) %>%
  bind_rows(tibble(
    group = "2",
    a = runif(10, 1, 1000),
    b = runif(10, 1, 1000)
  )) %>%
  bind_rows(tibble(
    group = "3",
    a = runif(10, 1, 1000),
    b = runif(10, 1, 1000)
  )) %>%
  group_by(group) %>%
  nest() %>%
  mutate(mdl = map(data, ~ loess(a ~ b, .)), fitted = map(mdl, `[[`, "fitted"))


```
